var cryptoObj=window.crypto||window.msCrypto;Bin={valid:function(a){return/^(0|1)+$/.test(a)}};Hex={from:function(a){for(var c=[],b=0;b<a.length;++b)c.push((parseInt(a[b],16)>>>0).toString(2).pad0(4));return c.join("")},to:function(a){a=a.match(/.{1,4}/g);return _.map(a,function(a){return parseInt(a,2).toString(16)}).join("")},valid:function(a){return/^(\d|[a-fA-F])+$/.test(a)}};
B64={sub:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/",from:function(a){for(var c="",b=0;b<a.length;++b)c+=B64.sub.split("").indexOf(a[b]).toString(2).pad0(6);return c},to:function(a){a=a.match(/.{1,6}/g);return _.map(a,function(a){return B64.sub[parseInt(a,2)]}).join("")},valid:function(a){return/^(\w|\+|\/)+$/.test(a)}};String.prototype.pad0=function(a){return String("0".repeat(a-this.length)+this)};
String.prototype.enc=function(a,c){if(a==c)return this;var b="bin"==a?this:"hex"==a?Hex.from(this):B64.from(this);return"bin"==c?b:"hex"==c?Hex.to(b):B64.to(b)};function string_to_utf8_array(a){a=window.atob(btoa(a));for(var c=new Uint8Array(new ArrayBuffer(a.length)),b=0;b<a.length;b++)c[b]=a.charCodeAt(b);return c}function int_array_to_bin_string(a){return _.map(a,function(a){return(a>>>0).toString(2)}).join("")}
function random_bin_string(a){a=new Int8Array(a);cryptoObj.getRandomValues(a);return _.map(a,function(a){return 0>a?0:1}).join("")}function xor(a,c){for(var b="",d=0;d<(a.length>c.length?a:c).length;++d)b+=a[d]==c[d]?"0":"1";return b}function random_integer(a,c){return Math.floor(Math.random()*(c-a+1)+a)}function random_prime(){var a;do a=random_integer(1048576,8388608);while(!fermat(a));return a}
function mod_exp(a,c,b){var d=1;for(a%=b;0<c;){var e=c%2;c=Math.floor(c/2);1==e&&(d*=a,d%=b);a*=a;a%=b}return d}function fermat(a){for(var c=0;5>c;++c){var b=random_integer(1,a);if(1!=mod_exp(b,a-1,a))return!1}return!0}function egcd(a,c){if(0==c)return[1,0,a];var b=egcd(c,a%c),d=b[1];return[d,b[0]-d*Math.floor(a/c),b[2]]}function gcd(a,c){return egcd(a,c)[2]}
$(function(){var a=0;$(".menu .col-sm-4").each(function(){a=Math.max(a,$(this).height())});$(".menu .col-sm-4").height(a);$("#implementations a").click(function(a){a.preventDefault();var b=$(this).parent().find("strong").html(),d=$(this).html();$("#the-modal").data("box",b+"-"+d).on("change",'input[name="enc"]',function(){var a=$(this).val();$(".enc_output").each(function(){$(this).val($(this).val().enc($(this).data("enc"),a));$(this).data("enc",a)})}).on("change",'input[name="input_enc"]',function(){$(".enc_input").val("").data("enc",
$(this).val()).prop("disabled",!1)});$.get("/c/"+b+"/"+d).done(function(a){$("#modal-title").html(b+" "+d);$("#modal-body").html(a);$.getScript("/client/js/boxes/"+b+"/"+d+".js").done(function(){$("#the-modal").modal("show")})}).fail(function(){alert("Operation not yet implemented")});return!1});$(".navbar a").click(function(a){a.preventDefault();$(".navbar li").removeClass("active");$(this).parent().addClass("active");$(".tab").hide();$($(this).attr("href")).show();return!1});$(document).on("click",
"input[type=text]",function(){$(this).prop("readonly")&&this.select()})});
