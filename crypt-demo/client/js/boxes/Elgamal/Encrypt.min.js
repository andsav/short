$("#elgamal_rgen").click(function(){var a=$("#elgamal_p").val(),b=$("#elgamal_g").val(),c=$("#elgamal_m").val(),d=$("#elgamal_k_pub").val();try{if(0==a.length||0==b.length||0==c.length||0==d.length)throw"Incomplete form";if(parseInt(a)!=a)throw"Invalid p value";if(parseInt(b)!=b)throw"Invalid g value";if(parseInt(c)!=c)throw"Invalid m value";if(parseInt(d)!=d)throw"Invalid k_pub value";$("#elgamal_r").val(random_integer(1,a-1)).prop("disabled",!1);$("#elgamal_encrypt").prop("disabled",!1)}catch(e){return alert(e),
!1}});
$("#elgamal_encrypt").click(function(){var a=$("#elgamal_p").val(),b=$("#elgamal_g").val(),c=$("#elgamal_m").val(),d=$("#elgamal_r").val(),e=$("#elgamal_k_pub").val();try{if(0==a.length||0==b.length||0==c.length||0==e.length)throw"Incomplete form";if(parseInt(a)!=a)throw"Invalid p value";if(parseInt(b)!=b)throw"Invalid g value";if(parseInt(c)!=c)throw"Invalid m value";if(parseInt(e)!=e)throw"Invalid k_pub value";var f="("+mod_exp(b,d,a)+", "+Big(c).mul(mod_exp(e,d,a)).toString()+")";$("#elgamal_c").val(f);$("#elgamal_output").show()}catch(g){return alert(g),
!1}$("#elgamal_rgen").one("click",function(){$("#elgamal_encrypt").click()})});
