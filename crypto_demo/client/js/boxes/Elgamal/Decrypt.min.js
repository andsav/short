$("#elgamal_decrypt").click(function(){var a=$("#elgamal_p").val(),c=$("#elgamal_c").val(),d=$("#elgamal_x").val(),e=/^\(((\d)+), ?((\d)+)\)$/;try{if(0==a.length)throw"Empty p";if(0==c.length)throw"Empty ciphertext";if(0==d.length)throw"Empty private key";if(!e.test(c))throw"Invalid ciphertext encoding";var f=e.exec(c),g=f[3],b=egcd(f[1],a)[0];0>b&&(b+=a);$("#elgamal_m").val(mod_exp(g*mod_exp(b,d,a),1,a));$("#elgamal_output").show()}catch(h){return alert(h),!1}});
