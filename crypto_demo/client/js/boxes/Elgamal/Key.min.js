function is_primitive_root(a,c){for(var b=1,d=mod_exp(a,b,c);1<d;)b++,d*=a,d%=c;return b!==c-1}$("#elgamal_version_choose button").click(function(){$(".elgamal_version").hide();$($(this).data("target")).show();$("#elgamal_version_choose").hide();$("#modal-title").append(" - "+$(this).html())});
$("#elgamal_pg").click(function(){var a=random_prime();do g=random_integer(1,a);while(!is_primitive_root(g,a));$("#elgamal_p").val(a).prop("disabled",!1);$("#elgamal_g").val(g).prop("disabled",!1);$("#elgamal_xgen").prop("disabled",!1)});$("#elgamal_xgen").click(function(){var a=parseInt($("#elgamal_p").val());$("#elgamal_x").val(random_integer(1,a-1)).prop("disabled",!1);$("#elgamal_keygen").prop("disabled",!1);$("#elgamal_pg").one("click",function(){$("#elgamal_xgen").click()})});
$("#elgamal_keygen").click(function(){var a=parseInt($("#elgamal_p").val()),c=parseInt($("#elgamal_g").val()),b=parseInt($("#elgamal_x").val());$("#elgamal_k_pub").val(mod_exp(c,b,a)).prop("disabled",!1);$("#elgamal_k_sec").val(b).prop("disabled",!1);$("#elgamal_output").show();$("#elgamal_xgen").one("click",function(){$("#elgamal_keygen").click()})});
