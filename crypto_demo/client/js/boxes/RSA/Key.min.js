function generate_e(a){var b;do b=random_integer(1,a);while(1!=gcd(b,a));return b}$("#rsa_pq").click(function(){$("#rsa_p").val(random_prime()).prop("disabled",!1);$("#rsa_q").val(random_prime()).prop("disabled",!1);$("#rsa_nphi").prop("disabled",!1)});
$("#rsa_nphi").click(function(){var a=parseInt($("#rsa_p").val()),b=parseInt($("#rsa_q").val());$("#rsa_n").val(Big(a).mul(b).toString()).prop("disabled",!1);$("#rsa_phi").val(Big(a-1).mul(b-1).toString()).prop("disabled",!1);$("#rsa_ed").prop("disabled",!1);$("#rsa_pq").one("click",function(){$("#rsa_nphi").click()})});
$("#rsa_ed").click(function(){var a=parseInt($("#rsa_phi").val()),b=parseInt($("#rsa_n").val()),c=generate_e(a),d=egcd(c,a),a=0>d[0]?a+d[0]:d[0];$("#rsa_e").val(c).prop("disabled",!1);$("#rsa_d").val(a).prop("disabled",!1);$("#rsa_pub").val("("+b+", "+c+")");$("#rsa_sec").val("("+b+", "+a+")");$("#rsa_output").show();$("#rsa_nphi").one("click",function(){$("#rsa_ed").click()})});
